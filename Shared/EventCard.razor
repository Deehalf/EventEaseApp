@using EventEaseApp.Models
@inject NavigationManager Nav

<div class="card mb-3" style="max-width:720px;">
    <div class="card-body d-flex justify-content-between align-items-start">
        <div>
            <h5 class="card-title mb-1">
                @EventItem?.Name
                @if (RegistrationCount > 0)
                {
                    <span class="badge bg-info ms-2" title="Registros">@RegistrationCount</span>
                }
            </h5>
            <h6 class="card-subtitle mb-2 text-muted">@EventItem?.Date.ToString("f")</h6>
            <p class="card-text"><strong>Ubicaci√≥n:</strong> @EventItem?.Location</p>
        </div>

        <div class="d-flex flex-column align-items-end">
            <div class="mb-2">
                <button class="btn btn-link p-0 me-3" @onclick="NavigateDetails">Detalles</button>
            </div>
            <div>
                <button class="btn btn-primary me-2" @onclick="NavigateRegister">Registrar</button>
                @if (OnDelete.HasDelegate)
                {
                    <button class="btn btn-danger" @onclick="OnDeleteClicked">Eliminar</button>
                }
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public Event? EventItem { get; set; }
    [Parameter] public EventCallback<int> OnDelete { get; set; }
    [Parameter] public int RegistrationCount { get; set; } = 0;

    private void NavigateDetails()
    {
        if (EventItem is not null)
            Nav.NavigateTo($"/events/{EventItem.Id}");
    }

    private void NavigateRegister()
    {
        if (EventItem is not null)
            Nav.NavigateTo($"/events/{EventItem.Id}/register");
    }

    private async Task OnDeleteClicked()
    {
        if (EventItem is not null)
            await OnDelete.InvokeAsync(EventItem.Id);
    }
}